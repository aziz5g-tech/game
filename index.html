<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <!-- ููุน ุงูุชุฎุฒูู ุงููุคูุช -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    
    <title>ุฎููุฉ ุงูุญุฑูู - ูุนุจุฉ ุงููุฑู</title>
    <link rel="stylesheet" href="styles.css?v=2.2">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- iOS Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ุฎููุฉ ุงูุญุฑูู">
    
    <!-- Android Meta Tags -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="ุฎููุฉ ุงูุญุฑูู">
    
    <!-- Theme Color -->
    <meta name="theme-color" content="#667eea">
    <meta name="msapplication-navbutton-color" content="#667eea">
    <meta name="apple-mobile-web-app-status-bar-style" content="#667eea">
    
    <!-- Touch Icons -->
    <link rel="apple-touch-icon" href="icon-192x192.png">
    <link rel="icon" type="image/png" sizes="192x192" href="icon-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="icon-512x512.png">
</head>
<body>
    <div class="game-container">
        <!-- ุดุงุดุฉ ุชุณุฌูู ุงูุฏุฎูู -->
        <div id="login-screen" class="screen active">
            <div class="logo">
                <h1>ุฎููุฉ ุงูุญุฑูู</h1>
                <p>ูุนุจุฉ ุงููุฑู ูุงููุนุฑูุฉ ุงูุฌูุงุนูุฉ</p>
            </div>
            
            <div class="login-form">
                <h3>ุฃุฏุฎู ุงุณูู ููุงูุถูุงู</h3>
                <div class="player-input">
                    <input type="text" id="player-name-input" placeholder="ุงุณู ุงููุงุนุจ" maxlength="20" required>
                    <button id="join-rooms-btn" class="btn primary" disabled>ุงูุถู ููุบุฑู</button>
                </div>
            </div>
        </div>

        <!-- ุดุงุดุฉ ุงูุบุฑู -->
        <div id="rooms-screen" class="screen">
            <div class="rooms-header">
                <div class="player-info">
                    <span class="player-avatar">๐ฎ</span>
                    <span class="player-name">ุงุณู ุงููุงุนุจ</span>
                </div>
                <button id="logout-btn" class="btn secondary">ุชุณุฌูู ุงูุฎุฑูุฌ</button>
            </div>
            
            <div class="rooms-content">
                <div class="rooms-actions">
                    <h2>ุงูุบุฑู ุงููุชุงุญุฉ</h2>
                    <div class="auto-refresh-info">
                        <span class="refresh-icon">๐</span>
                        <span class="refresh-text">ุชุชุญุฏุซ ุงููุงุฆูุฉ ุชููุงุฆูุงู ูู 10 ุซูุงู</span>
                    </div>
                    <button id="create-room-btn" class="btn primary">ุฅูุดุงุก ุบุฑูุฉ ุฌุฏูุฏุฉ</button>
                    <button id="refresh-rooms-btn" class="btn secondary">ุชุญุฏูุซ ุงููุงุฆูุฉ</button>
                    <button id="refresh-app-btn" class="btn info" onclick="forceRefresh()" title="ุฅุนุงุฏุฉ ุชุญููู ุงูุชุทุจูู">๐ ุชุญุฏูุซ ุงูุชุทุจูู</button>
                </div>
                
                <div class="rooms-list" id="rooms-list">
                    <!-- ุณูุชู ููุคูุง ุฏููุงููููุงู -->
                </div>
            </div>
        </div>

        <!-- ุดุงุดุฉ ุฅูุดุงุก ุบุฑูุฉ -->
        <div id="create-room-screen" class="screen">
            <div class="create-room-form">
                <h2>ุฅูุดุงุก ุบุฑูุฉ ุฌุฏูุฏุฉ</h2>
                
                <div class="info-box">
                    <div class="info-icon">๐</div>
                    <div class="info-text">
                        <strong>ุบุฑู ูุดุชุฑูุฉ ุนุจุฑ ุงูุฅูุชุฑูุช:</strong> ุณุชููู ุงูุบุฑูุฉ ูุฑุฆูุฉ ูุฌููุน ุงููุงุนุจูู ุนูู ุฃู ุฌูุงุฒ ููููููู ุงูุงูุถูุงู ุฅูููุง ููุฑุงู.
                    </div>
                </div>
                
                <div class="form-group">
                    <label>ุงุณู ุงูุบุฑูุฉ</label>
                    <input type="text" id="room-name-input" placeholder="ุฃุฏุฎู ุงุณู ุงูุบุฑูุฉ" maxlength="30" required>
                </div>
                <div class="form-actions">
                    <button id="create-room-confirm-btn" class="btn primary">ุฅูุดุงุก ุงูุบุฑูุฉ</button>
                    <button id="cancel-create-room-btn" class="btn secondary">ุฅูุบุงุก</button>
                </div>
            </div>
        </div>

        <!-- ุดุงุดุฉ ุงูุบุฑูุฉ -->
        <div id="room-screen" class="screen">
            <div class="room-header">
                <div class="room-info">
                    <h2 id="current-room-name" class="room-name">ุงุณู ุงูุบุฑูุฉ</h2>
                    <div class="room-status">ูู ุงูุงูุชุธุงุฑ</div>
                </div>
                <button id="leave-room-btn" class="btn danger">ูุบุงุฏุฑุฉ ุงูุบุฑูุฉ</button>
            </div>
            
            <div class="room-content">
                <div class="teams-preview">
                    <div class="team-preview green-team-preview">
                        <h3>ุงููุฑูู ุงูุฃุฎุถุฑ</h3>
                        <div class="team-players-list" id="green-players-list">
                            <!-- ุณูุชู ููุคูุง ุฏููุงููููุงู -->
                        </div>
                        <button id="join-green-team-btn" class="btn team-join-btn green">ุงูุถู ูููุฑูู ุงูุฃุฎุถุฑ</button>
                    </div>
                    
                    <div class="team-preview red-team-preview">
                        <h3>ุงููุฑูู ุงูุฃุญูุฑ</h3>
                        <div class="team-players-list" id="red-players-list">
                            <!-- ุณูุชู ููุคูุง ุฏููุงููููุงู -->
                        </div>
                        <button id="join-red-team-btn" class="btn team-join-btn red">ุงูุถู ูููุฑูู ุงูุฃุญูุฑ</button>
                    </div>
                </div>
                
                <div class="spectators-section">
                    <h4>ุงููุดุงูุฏูู</h4>
                    <div class="spectators-list" id="spectators-list">
                        <!-- ุณูุชู ููุคูุง ุฏููุงููููุงู -->
                    </div>
                </div>
                
                <div class="room-actions">
                    <button id="start-room-game-btn" class="btn primary" disabled>ุงุจุฏุฃ ุงููุนุจุฉ</button>
                    <button id="ready-btn" class="btn secondary">ุฌุงูุฒ</button>
                </div>
            </div>
        </div>
        <!-- ุดุงุดุฉ ุงูุจุฏุงูุฉ (ูููุถุน ุงููุฏูู ููุท) -->
        <div id="start-screen" class="screen">
            <div class="logo">
                <h1>ุฎููุฉ ุงูุญุฑูู</h1>
                <p>ูุนุจุฉ ุงููุฑู ูุงููุนุฑูุฉ</p>
            </div>
            
            <div class="team-setup">
                <div class="team-section green-team">
                    <h3>ุงููุฑูู ุงูุฃุฎุถุฑ</h3>
                    <div class="player-inputs">
                        <input type="text" placeholder="ุงููุงุนุจ ุงูุฃูู" class="player-name" data-team="green" data-player="1" required>
                        <input type="text" placeholder="ุงููุงุนุจ ุงูุซุงูู (ุงุฎุชูุงุฑู)" class="player-name" data-team="green" data-player="2">
                        <input type="text" placeholder="ุงููุงุนุจ ุงูุซุงูุซ (ุงุฎุชูุงุฑู)" class="player-name" data-team="green" data-player="3">
                    </div>
                </div>
                
                <div class="team-section red-team">
                    <h3>ุงููุฑูู ุงูุฃุญูุฑ</h3>
                    <div class="player-inputs">
                        <input type="text" placeholder="ุงููุงุนุจ ุงูุฃูู" class="player-name" data-team="red" data-player="1" required>
                        <input type="text" placeholder="ุงููุงุนุจ ุงูุซุงูู (ุงุฎุชูุงุฑู)" class="player-name" data-team="red" data-player="2">
                        <input type="text" placeholder="ุงููุงุนุจ ุงูุซุงูุซ (ุงุฎุชูุงุฑู)" class="player-name" data-team="red" data-player="3">
                    </div>
                </div>
            </div>
            
            <button id="start-game-btn" class="btn primary">ุงุจุฏุฃ ุงููุนุจุฉ</button>
        </div>

        <!-- ุดุงุดุฉ ุงููุนุจุฉ ุงูุฑุฆูุณูุฉ -->
        <div id="game-screen" class="screen">
            <div class="game-header">
                <div class="team-info green-info">
                    <div class="team-name">ุงููุฑูู ุงูุฃุฎุถุฑ</div>
                    <div class="team-score">0</div>
                    <div class="team-players"></div>
                </div>
                
                <div class="current-turn">
                    <div class="turn-indicator">ุฏูุฑ ุงููุฑูู:</div>
                    <div class="turn-team">ุงูุฃุฎุถุฑ</div>
                </div>
                
                <div class="team-info red-info">
                    <div class="team-name">ุงููุฑูู ุงูุฃุญูุฑ</div>
                    <div class="team-score">0</div>
                    <div class="team-players"></div>
                </div>
            </div>
            
            <!-- ุดุจูุฉ ุงูุญุฑูู 5x5 -->
            <div class="letters-grid" id="letters-grid">
                <!-- ุณูุชู ุฅูุดุงุก ุงูุญุฑูู ุฏููุงููููุงู ุจู JavaScript -->
            </div>
            
            <div class="game-controls">
                <button id="reset-game-btn" class="btn secondary">ุฅุนุงุฏุฉ ุงููุนุจุฉ</button>
                <button id="end-game-btn" class="btn danger">ุฅููุงุก ุงููุนุจุฉ</button>
            </div>
        </div>

        <!-- ูุงูุฐุฉ ุงูุณุคุงู -->
        <div id="question-modal" class="modal">
            <div class="modal-content">
                <div class="question-header">
                    <span class="selected-letter"></span>
                    <span class="current-team-name"></span>
                </div>
                
                <div class="question-text"></div>
                
                <div class="answer-options">
                    <button class="answer-btn" data-answer="A"></button>
                    <button class="answer-btn" data-answer="B"></button>
                    <button class="answer-btn" data-answer="C"></button>
                    <button class="answer-btn" data-answer="D"></button>
                </div>
                
                <div class="question-timer">
                    <div class="timer-bar"></div>
                    <span class="timer-text">30</span>
                </div>
            </div>
        </div>

        <!-- ุดุงุดุฉ ุงููุชุงุฆุฌ -->
        <div id="results-screen" class="screen">
            <div class="results-content">
                <h2>ุงูุชูุช ุงููุนุจุฉ!</h2>
                <div class="winner-announcement"></div>
                <div class="final-scores">
                    <div class="team-final-score green">
                        <span class="team-name">ุงููุฑูู ุงูุฃุฎุถุฑ</span>
                        <span class="score">0</span>
                    </div>
                    <div class="team-final-score red">
                        <span class="team-name">ุงููุฑูู ุงูุฃุญูุฑ</span>
                        <span class="score">0</span>
                    </div>
                </div>
                <button id="play-again-btn" class="btn primary">ุงูุนุจ ูุฑุฉ ุฃุฎุฑู</button>
            </div>
        </div>
    </div>

    <script src="config.js?v=2.0"></script>
    <script src="questions.js?v=2.0"></script>
    <script src="shared-storage.js?v=2.2"></script>
    <script src="script.js?v=2.2"></script>
    
    <!-- Service Worker Registration -->
    <script>
        // ุชุณุฌูู Service Worker ููู PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('./sw.js')
                    .then(function(registration) {
                        console.log('SW registered with scope: ', registration.scope);
                    })
                    .catch(function(error) {
                        console.log('SW registration failed: ', error);
                    });
            });
        }
        
        // ุฅุถุงูุฉ ููุดุงุดุฉ ุงูุฑุฆูุณูุฉ
        let deferredPrompt;
        const installButton = document.createElement('button');
        
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // ุฅุธูุงุฑ ุฒุฑ ุงูุชุซุจูุช
            installButton.textContent = 'ุชุซุจูุช ุงููุนุจุฉ';
            installButton.className = 'btn primary install-btn';
            installButton.style.margin = '10px';
            installButton.addEventListener('click', async () => {
                if (deferredPrompt) {
                    deferredPrompt.prompt();
                    const { outcome } = await deferredPrompt.userChoice;
                    console.log(`User response to the install prompt: ${outcome}`);
                    deferredPrompt = null;
                    installButton.style.display = 'none';
                }
            });
            
            // ุฅุถุงูุฉ ุงูุฒุฑ ูุดุงุดุฉ ุงูุจุฏุงูุฉ
            const startScreen = document.getElementById('start-screen');
            startScreen.appendChild(installButton);
        });
        
        // ุฅุฎูุงุก ุฒุฑ ุงูุชุซุจูุช ุจุนุฏ ุงูุชุซุจูุช
        window.addEventListener('appinstalled', () => {
            installButton.style.display = 'none';
            deferredPrompt = null;
            console.log('PWA was installed');
        });
    </script>
</body>
</html>
